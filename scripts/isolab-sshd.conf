# isolab-sshd â€” Dedicated sshd for auto-provisioning containers
#
# Listens on port 2222. Any key in ~/.config/isolab/authorized_keys
# can connect and gets dropped into a container automatically.

Port 2222
ListenAddress 0.0.0.0

# Key auth only
PubkeyAuthentication yes
PasswordAuthentication no
KbdInteractiveAuthentication no

# Look up keys from isolab's config via the authkeys script
AuthorizedKeysCommand /home/mike/isolab/scripts/isolab-authkeys %u %f %t %k
AuthorizedKeysCommandUser mike

# No regular authorized_keys lookup
AuthorizedKeysFile none

# Host keys (reuse system keys)
HostKey /etc/ssh/ssh_host_ed25519_key
HostKey /etc/ssh/ssh_host_rsa_key

# Logging
SyslogFacility AUTH
LogLevel INFO

# Security
PermitRootLogin no
AllowUsers mike
MaxAuthTries 3
MaxSessions 5
LoginGraceTime 30

# Allow PTY for interactive sessions
PermitTTY yes
X11Forwarding no
AllowAgentForwarding no
AllowTcpForwarding no
